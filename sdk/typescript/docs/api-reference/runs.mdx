---
title: "Runs API"
description: "API reference for executing and managing agent runs"
icon: "play"
---

The Runs API provides methods for executing agents, streaming responses, and managing run lifecycle.

Access the Runs API via `client.runs`.

## Methods

### run

Executes an agent and returns the final output. Internally streams all events and accumulates the response.

```typescript
run(options: CreateRunOptions): Promise<string>
```

<ParamField path="options" type="CreateRunOptions" required>
  Run configuration
</ParamField>

```typescript
const output = await client.runs.run({
  agentId: 'agt_abc123',
  prompt: 'List all TypeScript files',
  sessionId: 'sess_xyz' // optional
});

console.log(output);
```

**Returns:** `Promise<string>` - The accumulated text output

**Throws:**
- `NotFoundError` - Agent not found
- `RunFailedError` - Run failed during execution
- `RunCancelledError` - Run was cancelled
- `AuthenticationError` - Invalid API key

---

### stream

Creates a streaming run that yields events in real-time.

```typescript
stream(options: CreateRunOptions): Promise<RunStream>
```

<ParamField path="options" type="CreateRunOptions" required>
  Run configuration
</ParamField>

```typescript
const stream = await client.runs.stream({
  agentId: 'agt_abc123',
  prompt: 'Explain async/await'
});

for await (const event of stream) {
  if (event.type === 'message.delta') {
    process.stdout.write(event.content);
  }
}
```

**Returns:** `Promise<RunStream>` - An async iterable of events

**Throws:**
- `NotFoundError` - Agent not found
- `AuthenticationError` - Invalid API key

---

### get

Retrieves a run by ID.

```typescript
get(runId: string): Promise<Run>
```

<ParamField path="runId" type="string" required>
  Run ID (with or without `run_` prefix)
</ParamField>

```typescript
const run = await client.runs.get('run_xyz789');

console.log(run.status);  // 'completed'
console.log(run.output);  // Final output
console.log(run.usage);   // Token usage
```

**Returns:** `Promise<Run>`

**Throws:**
- `NotFoundError` - Run not found
- `AuthenticationError` - Invalid API key

---

### list

Lists runs with optional filters.

```typescript
list(options?: ListRunsOptions): Promise<Run[]>
```

<ParamField path="options" type="ListRunsOptions" optional>
  Filter and pagination options
</ParamField>

```typescript
// List all runs
const runs = await client.runs.list();

// Filter by agent
const agentRuns = await client.runs.list({
  agentId: 'agt_abc123'
});

// Filter by status with pagination
const completedRuns = await client.runs.list({
  status: 'completed',
  limit: 20,
  offset: 0
});
```

**Returns:** `Promise<Run[]>`

**Throws:**
- `AuthenticationError` - Invalid API key

---

### cancel

Cancels a pending or running run.

```typescript
cancel(runId: string): Promise<Run>
```

<ParamField path="runId" type="string" required>
  Run ID to cancel
</ParamField>

```typescript
const cancelled = await client.runs.cancel('run_xyz789');
console.log(cancelled.status); // 'cancelled'
```

**Returns:** `Promise<Run>` - The cancelled run

**Throws:**
- `NotFoundError` - Run not found
- `ConflictError` - Run already completed
- `AuthenticationError` - Invalid API key

---

### resumeStream

Resumes streaming from an existing run.

```typescript
resumeStream(runId: string): Promise<RunStream>
```

<ParamField path="runId" type="string" required>
  Run ID to resume
</ParamField>

```typescript
try {
  for await (const event of stream) {
    // Process...
  }
} catch (error) {
  // Connection lost - resume
  const resumed = await client.runs.resumeStream(runId);
  for await (const event of resumed) {
    // Continue...
  }
}
```

**Returns:** `Promise<RunStream>`

**Throws:**
- `NotFoundError` - Run not found
- `AuthenticationError` - Invalid API key

---

## Types

### CreateRunOptions

Options for creating a run.

```typescript
interface CreateRunOptions {
  /**
   * Agent ID to run.
   * The `agt_` prefix is optional.
   */
  agentId: string;

  /**
   * Prompt to send to the agent.
   */
  prompt: string;

  /**
   * Session ID for conversation continuity.
   * Use the same session ID across multiple runs to maintain context.
   */
  sessionId?: string;
}
```

### Run

The complete run object.

```typescript
interface Run {
  /** Unique run ID (e.g., 'run_xyz789') */
  id: string;

  /** Agent ID that executed the run */
  agentId: string;

  /** Current run status */
  status: RunStatus;

  /** The input prompt */
  prompt: string;

  /** Final output (if completed) */
  output: string | null;

  /** Error message (if failed) */
  errorMessage: string | null;

  /** Session ID (if provided) */
  sessionId: string | null;

  /** Token usage metrics (if completed) */
  usage: UsageMetrics | null;

  /** Number of conversation turns */
  turns: number;

  /** Total duration in milliseconds */
  durationMs: number;

  /** Tools invoked during the run */
  toolsUsed: string[];

  /** Creation timestamp (ISO 8601) */
  createdAt: string;

  /** Start timestamp (ISO 8601) */
  startedAt: string | null;

  /** Completion timestamp (ISO 8601) */
  completedAt: string | null;
}
```

### RunStatus

Run status values.

```typescript
type RunStatus =
  | 'pending'    // Waiting to start
  | 'running'    // Currently executing
  | 'completed'  // Finished successfully
  | 'failed'     // Failed with error
  | 'cancelled'  // Cancelled by user
```

### UsageMetrics

Token usage metrics.

```typescript
interface UsageMetrics {
  /** Tokens in the prompt */
  inputTokens: number;

  /** Tokens in the response */
  outputTokens: number;

  /** Total tokens (input + output) */
  totalTokens: number;
}
```

### ListRunsOptions

Options for listing runs.

```typescript
interface ListRunsOptions {
  /**
   * Filter by agent ID.
   */
  agentId?: string;

  /**
   * Filter by run status.
   */
  status?: RunStatus;

  /**
   * Maximum number of results.
   * @default 100
   * @minimum 1
   * @maximum 100
   */
  limit?: number;

  /**
   * Number of results to skip.
   * @default 0
   */
  offset?: number;
}
```

## Error Handling

```typescript
import {
  NotFoundError,
  RunFailedError,
  RunCancelledError,
  ConflictError
} from '@superserve/sdk';

try {
  const output = await client.runs.run({ agentId, prompt });
} catch (error) {
  if (error instanceof RunFailedError) {
    console.error(`Run ${error.runId} failed: ${error.message}`);
    console.error('Error code:', error.code);
  } else if (error instanceof RunCancelledError) {
    console.error(`Run ${error.runId} was cancelled`);
  } else if (error instanceof NotFoundError) {
    console.error('Agent not found');
  }
}
```
